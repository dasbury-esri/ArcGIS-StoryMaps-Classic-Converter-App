---
title: Notebook vs App Flow – Map Series Conversion
format: html
---

This document compares the ArcGIS Notebook (Python) flow with the converter app (TypeScript/JavaScript) flow for Classic Map Series → ArcGIS StoryMaps conversion.

::: {layout-ncol=2}
::: column
## ArcGIS Notebooks (Python)

```{mermaid}
flowchart TB
  A1([Start]) --> A2[Setup and authenticate]
  A2 --> A3[Input classic item id]
  A3 --> A4[Fetch classic item data]
  A4 --> A5[Extract theme title entries]
  A5 --> A6[Loop entries]
  A6 --> A6a[Classify media]
  A6a --> A6a1{Media type}
  A6a1 -->|webmap| A6w[Parse webmap JSON and extent]
  A6a1 -->|image| A6i[Resolve image URL]
  A6a1 -->|video| A6v[Resolve video/embed URL]
  A6a1 -->|embed| A6e1[Resolve webpage URL]
  A6w --> A6b[Parse side panel HTML]
  A6i --> A6b
  A6v --> A6b
  A6e1 --> A6b
  A6b --> A6c[Generate thumbnails]
  A6c --> A6c1{Thumb source}
  A6c1 -->|map| A6c2[Render extent to image]
  A6c1 -->|image| A6c3[Fetch image and downscale]
  A6c1 -->|video| A6c4[Use default thumbnail]
  A6c1 -->|embed| A6c5[Fallback default thumbnail]
  A6c2 --> A6d
  A6c3 --> A6d
  A6c4 --> A6d
  A6c5 --> A6d
  A6d[Build StoryMap nodes]
  A6d --> A6e[Suppress cover page]
  A6e --> A6f[Create StoryMap item]
  A6f --> A7[Publish story]
  A7 --> A8[Collect published items]
  A8 --> A9[Create Collection]
  A9 --> A10[Optional create folder]
  A10 --> A11[Move items to folder]
  A11 --> A12([Done])
```
:::

::: column
## Converter App (TS/JS)

```{mermaid}
flowchart TB
  B1([Start]) --> B2[Load or fetch classic JSON]
  B2 --> B3[Detect classic template]
  B3 -->|Series| B4[MapSeriesConverter convertSeries]
  B4 --> B5[Apply theme via computeTheme]
  B5 --> B6[Loop entries]
  B6 --> B6a[Classify media]
  B6a --> B6a1{Media type}
  B6a1 -->|webmap| B6w[Create webmap resource and node]
  B6a1 -->|image| B6i[Create image node]
  B6a1 -->|video| B6v[Create embed node]
  B6a1 -->|embed| B6e1[Create embed node]
  B6w --> B7[Enrich webmap extent viewpoint]
  B7 --> B6b[Build narrative panel]
  B6i --> B6b
  B6v --> B6b
  B6e1 --> B6b
  B6b --> B6c[Generate thumbnails]
  B6c --> B6c1{Thumb source}
  B6c1 -->|map| B6c2[Render extent to image]
  B6c1 -->|image| B6c3[Fetch image and downscale]
  B6c1 -->|video| B6c4[Use default thumbnail]
  B6c1 -->|embed| B6c5[Fallback default thumbnail]
  B6c2 --> B8
  B6c3 --> B8
  B6c4 --> B8
  B6c5 --> B8
  B8[Collect story JSONs and titles]
  B8 --> B9[Persist drafts to tmp-converted]
  B9 --> B10[Show builder links]
  B10 --> B11([Done])
```
:::
:::

---

## Key Differences

- Orchestration: Python uses widgets and ArcGIS Python API; App uses TS modules, `ConverterFactory`, and `BaseConverter` lifecycle.
- Theme: Python extracts and stores theme; App resolves with `computeTheme` (themeId + overrides) consistently across converters.
- Output: Python publishes items and builds a live Collection; App writes draft JSONs locally (tmp-converted) and surfaces builder links.
- Enrichment: Both enrich maps, but App embeds extent/viewpoint on resources and nodes during build for quick inspection.
- UX: Python flow is button-driven in Notebook UI; App runs in browser UI with test tasks for validation.

---

## Notes

- Mermaid labels are simplified for Mermaid v11 compatibility.
- This page focuses on Map Series; see QUARTO_LOGIC_DIAGRAM.qmd for full converter flows.
